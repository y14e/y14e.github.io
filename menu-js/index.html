<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<title>menu.js</title>
<link href="./index.css" rel="stylesheet">
</head>
<body>
<div class="menu">
  <div data-menu>
    <button data-menu-trigger>Button</button>
    <ul role="menu">
      <li role="none"><button role="menuitem">Lorem</button></li>
      <li role="none"><button role="menuitem">Ipsum</button>
        <ul role="menu">
          <li role="none"><button role="menuitem">Sub lorem</button></li>
          <li role="none"><button disabled role="menuitem">Sub ipsum (disabled)</button></li>
          <li role="none"><button role="menuitem">Sub dolor</button>
            <ul role="menu">
              <li role="none"><button disabled role="menuitem">Sub sub lorem (disabled)</button></li>
              <li role="none"><button role="menuitem">Sub sub ipsum</button></li>
              <li role="none"><button role="menuitem">Sub sub dolor</button></li>
              <li role="none"><button role="menuitem">Sub sub sit</button>
                <ul role="menu">
                  <li role="none"><button role="menuitem">Sub sub sub lorem</button></li>
                  <li role="none"><button role="menuitem">Sub sub sub ipsum</button></li>
                  <li role="none"><button role="menuitem">Sub sub sub dolor</button></li>
                </ul>
              </li>
            </ul>
          </li>
          <li role="none"><button role="menuitem">Sub sit</button>
            <ul role="menu">
              <li role="none"><button role="menuitem">Sub sub lorem</button></li>
              <li role="none"><button role="menuitem">Sub sub ipsum</button></li>
            </ul>
          </li>
          <li role="none"><button role="menuitem">Sub amet</button></li>
        </ul>
      </li>
      <li role="none"><button disabled role="menuitem">Dolor (disabled)</button></li>
      <li role="none"><button role="menuitem">Sit</button></li>
      <li role="none"><button disabled role="menuitem">Amet (disabled)</button>
        <ul role="menu">
          <li role="none"><button role="menuitem">Sub lorem</button></li>
          <li role="none"><button role="menuitem">Sub ipsum</button></li>
        </ul>
      </li>
      <li role="none"><button role="menuitem">Consectetur</button></li>
      <li role="none"><button role="menuitem">Adipiscing</button></li>
      <li role="none"><button role="menuitem">Elit</button></li>
    </ul>
  </div>
  <div data-menu>
    <button data-menu-trigger disabled>Button (disabled)</button>
    <ul role="menu">
      <li role="none"><button role="menuitem">Lorem</button></li>
      <li role="none"><button role="menuitem">Ipsum</button></li>
      <li role="none"><button role="menuitem">Dolor</button></li>
      <li role="none"><button role="menuitem">Sit</button></li>
      <li role="none"><button role="menuitem">Amet</button></li>
      <li role="none"><button role="menuitem">Consectetur</button></li>
      <li role="none"><button role="menuitem">Adipiscing</button></li>
      <li role="none"><button role="menuitem">Elit</button></li>
    </ul>
  </div>
  <div data-menu>
    <button data-menu-trigger>Button</button>
    <div role="menu">
      <ul role="group">
        <li role="none"><button aria-checked="false" role="menuitemcheckbox">Checkbox lorem</button></li>
        <li role="none"><button aria-checked="true" role="menuitemcheckbox">Checkbox ipsum</button></li>
        <li role="none"><button aria-checked="false" role="menuitemcheckbox">Checkbox dolor</button></li>
      </ul>
      <hr role="separator">
      <ul role="group">
        <li role="none"><button aria-checked="true" role="menuitemradio">Radio sit</button></li>
        <li role="none"><button aria-checked="false" role="menuitemradio">Radio amet</button></li>
        <li role="none"><button aria-checked="false" role="menuitemradio">Radio consectetur</button></li>
      </ul>
      <hr role="separator">
      <ul role="group">
        <li role="none"><button aria-checked="false" role="menuitemradio">Radio adipiscing</button></li>
        <li role="none"><button aria-checked="true" role="menuitemradio">Radio elit</button></li>
      </ul>
    </div>
  </div>
  <div data-menu>
    <button data-menu-trigger>Button</button>
    <ul role="menu">
      <li role="none"><a href="#anchor" role="menuitem">Lorem</a></li>
      <li role="none"><a href="#anchor" role="menuitem">Ipsum</a></li>
      <li role="none"><a aria-disabled="true" href="#anchor" role="menuitem">Dolor (disabled)</a></li>
      <li role="none"><a href="#anchor" role="menuitem">Sit</a></li>
    </ul>
  </div>
  <div data-menu>
    <ul role="menu">
      <li role="none"><button role="menuitem">Lorem</button></li>
      <li role="none"><button role="menuitem">Ipsum</button>
        <ul role="menu">
          <li role="none"><button role="menuitem">Sub lorem</button></li>
          <li role="none"><button disabled role="menuitem">Sub ipsum (disabled)</button></li>
          <li role="none"><button role="menuitem">Sub dolor</button>
            <ul role="menu">
              <li role="none"><button disabled role="menuitem">Sub sub lorem (disabled)</button></li>
              <li role="none"><button role="menuitem">Sub sub ipsum</button></li>
              <li role="none"><button role="menuitem">Sub sub dolor</button></li>
              <li role="none"><button role="menuitem">Sub sub sit</button>
                <ul role="menu">
                  <li role="none"><button role="menuitem">Sub sub sub lorem</button></li>
                  <li role="none"><button role="menuitem">Sub sub sub ipsum</button></li>
                  <li role="none"><button role="menuitem">Sub sub sub dolor</button></li>
                </ul>
              </li>
            </ul>
          </li>
          <li role="none"><button role="menuitem">Sub sit</button>
            <ul role="menu">
              <li role="none"><button role="menuitem">Sub sub lorem</button></li>
              <li role="none"><button role="menuitem">Sub sub ipsum</button></li>
            </ul>
          </li>
          <li role="none"><button role="menuitem">Sub amet</button></li>
        </ul>
      </li>
      <li role="none"><button disabled role="menuitem">Dolor (disabled)</button></li>
      <li role="none"><button role="menuitem">Sit</button></li>
      <li role="none"><button disabled role="menuitem">Amet (disabled)</button>
        <ul role="menu">
          <li role="none"><button role="menuitem">Sub lorem</button></li>
          <li role="none"><button role="menuitem">Sub ipsum</button></li>
        </ul>
      </li>
      <li role="none"><button role="menuitem">Consectetur</button></li>
      <li role="none"><button role="menuitem">Adipiscing</button></li>
      <li role="none"><button role="menuitem">Elit</button></li>
    </ul>
  </div>
  <div data-menu>
    <ul role="menu">
      <li role="none"><a href="#anchor" role="menuitem">Lorem (disabled)</a></li>
      <li role="none"><a href="#anchor" role="menuitem">Ipsum</a></li>
      <li role="none"><a href="#anchor" role="menuitem">Dolor</a></li>
      <li role="none"><a href="#anchor" role="menuitem">Sit</a></li>
      <li role="none"><a href="#anchor" role="menuitem">Amet</a></li>
      <li role="none"><a href="#anchor" role="menuitem">Consectetur</a></li>
      <li role="none"><a href="#anchor" role="menuitem">Adipiscing</a></li>
      <li role="none"><a aria-disabled="true" href="#anchor" role="menuitem">Elit (disabled)</a></li>
    </ul>
  </div>
</div>
<br><br><br><br><br>
<div class="menu">
  <div data-menu>
    <button data-menu-trigger>Button</button>
    <ul role="menu">
      <li role="none"><button role="menuitem">Lorem</button></li>
      <li role="none"><button role="menuitem">Ipsum</button>
        <ul role="menu">
          <li role="none"><button role="menuitem">Sub lorem</button></li>
          <li role="none"><button disabled role="menuitem">Sub ipsum (disabled)</button></li>
          <li role="none"><button role="menuitem">Sub dolor</button>
            <ul role="menu">
              <li role="none"><button disabled role="menuitem">Sub sub lorem (disabled)</button></li>
              <li role="none"><button role="menuitem">Sub sub ipsum</button></li>
              <li role="none"><button role="menuitem">Sub sub dolor</button></li>
              <li role="none"><button role="menuitem">Sub sub sit</button>
                <ul role="menu">
                  <li role="none"><button role="menuitem">Sub sub sub lorem</button></li>
                  <li role="none"><button role="menuitem">Sub sub sub ipsum</button></li>
                  <li role="none"><button role="menuitem">Sub sub sub dolor</button></li>
                </ul>
              </li>
            </ul>
          </li>
          <li role="none"><button role="menuitem">Sub sit</button>
            <ul role="menu">
              <li role="none"><button role="menuitem">Sub sub lorem</button></li>
              <li role="none"><button role="menuitem">Sub sub ipsum</button></li>
            </ul>
          </li>
          <li role="none"><button role="menuitem">Sub amet</button></li>
        </ul>
      </li>
      <li role="none"><button disabled role="menuitem">Dolor (disabled)</button></li>
      <li role="none"><button role="menuitem">Sit</button></li>
      <li role="none"><button disabled role="menuitem">Amet (disabled)</button>
        <ul role="menu">
          <li role="none"><button role="menuitem">Sub lorem</button></li>
          <li role="none"><button role="menuitem">Sub ipsum</button></li>
        </ul>
      </li>
      <li role="none"><button role="menuitem">Consectetur</button></li>
      <li role="none"><button role="menuitem">Adipiscing</button></li>
      <li role="none"><button role="menuitem">Elit</button></li>
    </ul>
  </div>
  <div data-menu>
    <button data-menu-trigger disabled>Button (disabled)</button>
    <ul role="menu">
      <li role="none"><button role="menuitem">Lorem</button></li>
      <li role="none"><button role="menuitem">Ipsum</button></li>
      <li role="none"><button role="menuitem">Dolor</button></li>
      <li role="none"><button role="menuitem">Sit</button></li>
      <li role="none"><button role="menuitem">Amet</button></li>
      <li role="none"><button role="menuitem">Consectetur</button></li>
      <li role="none"><button role="menuitem">Adipiscing</button></li>
      <li role="none"><button role="menuitem">Elit</button></li>
    </ul>
  </div>
  <div data-menu>
    <button data-menu-trigger>Button</button>
    <div role="menu">
      <ul role="group">
        <li role="none"><button aria-checked="false" role="menuitemcheckbox">Checkbox lorem</button></li>
        <li role="none"><button aria-checked="true" role="menuitemcheckbox">Checkbox ipsum</button></li>
        <li role="none"><button aria-checked="false" role="menuitemcheckbox">Checkbox dolor</button></li>
      </ul>
      <hr role="separator">
      <ul role="group">
        <li role="none"><button aria-checked="true" role="menuitemradio">Radio sit</button></li>
        <li role="none"><button aria-checked="false" role="menuitemradio">Radio amet</button></li>
        <li role="none"><button aria-checked="false" role="menuitemradio">Radio consectetur</button></li>
      </ul>
      <hr role="separator">
      <ul role="group">
        <li role="none"><button aria-checked="false" role="menuitemradio">Radio adipiscing</button></li>
        <li role="none"><button aria-checked="true" role="menuitemradio">Radio elit</button></li>
      </ul>
    </div>
  </div>
  <div data-menu>
    <button data-menu-trigger>Button</button>
    <ul role="menu">
      <li role="none"><a href="#anchor" role="menuitem">Lorem</a></li>
      <li role="none"><a href="#anchor" role="menuitem">Ipsum</a></li>
      <li role="none"><a aria-disabled="true" href="#anchor" role="menuitem">Dolor (disabled)</a></li>
      <li role="none"><a href="#anchor" role="menuitem">Sit</a></li>
    </ul>
  </div>
  <div data-menu>
    <ul role="menu">
      <li role="none"><button role="menuitem">Lorem</button></li>
      <li role="none"><button role="menuitem">Ipsum</button>
        <ul role="menu">
          <li role="none"><button role="menuitem">Sub lorem</button></li>
          <li role="none"><button disabled role="menuitem">Sub ipsum (disabled)</button></li>
          <li role="none"><button role="menuitem">Sub dolor</button>
            <ul role="menu">
              <li role="none"><button disabled role="menuitem">Sub sub lorem (disabled)</button></li>
              <li role="none"><button role="menuitem">Sub sub ipsum</button></li>
              <li role="none"><button role="menuitem">Sub sub dolor</button></li>
              <li role="none"><button role="menuitem">Sub sub sit</button>
                <ul role="menu">
                  <li role="none"><button role="menuitem">Sub sub sub lorem</button></li>
                  <li role="none"><button role="menuitem">Sub sub sub ipsum</button></li>
                  <li role="none"><button role="menuitem">Sub sub sub dolor</button></li>
                </ul>
              </li>
            </ul>
          </li>
          <li role="none"><button role="menuitem">Sub sit</button>
            <ul role="menu">
              <li role="none"><button role="menuitem">Sub sub lorem</button></li>
              <li role="none"><button role="menuitem">Sub sub ipsum</button></li>
            </ul>
          </li>
          <li role="none"><button role="menuitem">Sub amet</button></li>
        </ul>
      </li>
      <li role="none"><button disabled role="menuitem">Dolor (disabled)</button></li>
      <li role="none"><button role="menuitem">Sit</button></li>
      <li role="none"><button disabled role="menuitem">Amet (disabled)</button>
        <ul role="menu">
          <li role="none"><button role="menuitem">Sub lorem</button></li>
          <li role="none"><button role="menuitem">Sub ipsum</button></li>
        </ul>
      </li>
      <li role="none"><button role="menuitem">Consectetur</button></li>
      <li role="none"><button role="menuitem">Adipiscing</button></li>
      <li role="none"><button role="menuitem">Elit</button></li>
    </ul>
  </div>
  <div data-menu>
    <ul role="menu">
      <li role="none"><a aria-disabled="true" href="#anchor" role="menuitem">Lorem (disabled)</a></li>
      <li role="none"><a href="#anchor" role="menuitem">Ipsum</a></li>
      <li role="none"><a href="#anchor" role="menuitem">Dolor</a></li>
      <li role="none"><a href="#anchor" role="menuitem">Sit</a></li>
      <li role="none"><a href="#anchor" role="menuitem">Amet</a></li>
      <li role="none"><a href="#anchor" role="menuitem">Consectetur</a></li>
      <li role="none"><a href="#anchor" role="menuitem">Adipiscing</a></li>
      <li role="none"><a aria-disabled="true" href="#anchor" role="menuitem">Elit (disabled)</a></li>
    </ul>
  </div>
</div>
<a id="anchor"></a>
<script type="module">
import { flip, offset, shift } from 'https://cdn.jsdelivr.net/npm/@floating-ui/dom@1.7.1/+esm';
import Menu from './menu.js';
const myMenuOptions = {
  popover: {
    menu: {
      middleware: [flip({ padding: 4 }), offset(4), shift()],
    },
    submenu: {
      middleware: [flip(), offset({ alignmentAxis: -4, mainAxis: 4 }), shift({ mainAxis: false })],
    },
  },
};
document.querySelectorAll('[data-menu]').forEach(element => {
  const myMenu = new Menu(element, myMenuOptions);
  element.querySelectorAll('[role="menuitem"]:not([aria-haspopup])').forEach(item => {
    item.addEventListener('click', () => {
      console.log(item.textContent);
      myMenu.close();
    });
  });
  element.querySelectorAll('[role="menuitemcheckbox"]').forEach(item => item.addEventListener('click', () => console.log([...(item.closest('[role="group"]') || item.closest('[role="menu"]')).querySelectorAll('[role="menuitemcheckbox"]')].filter(item => item.getAttribute('aria-checked') === 'true').map(item => item.textContent))));
  element.querySelectorAll('[role="menuitemradio"]').forEach(item => item.addEventListener('click', () => console.log([...(item.closest('[role="group"]') || item.closest('[role="menu"]')).querySelectorAll('[role="menuitemradio"]')].filter(item => item.getAttribute('aria-checked') === 'true').map(item => item.textContent))));
  window.addEventListener('blur', () => myMenu.close());
});
</script>
</body>
</html>
